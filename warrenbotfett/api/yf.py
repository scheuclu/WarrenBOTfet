from datetime import datetime
from typing import Literal

import logfire
import yfinance as yf
from pydantic import BaseModel, Field

from warrenbotfett.common import ToolError
from dotenv import load_dotenv
load_dotenv()
from pydantic_ai import Agent, Tool

logfire.configure()
logfire.instrument_pydantic_ai()

data_collection_agent=Agent(
    # model="openai:o3",
    # model="gpt-4o",
    # model='openai:gpt-4o-mini',
    model="google-gla:gemini-2.5-flash",
    # model="google-gla:gemini-2.5-flash",
    # model_settings=settings,
    system_prompt=(
        "Your job is to extract information from html without doing interpretation. You should give back just the text of the news article."
    ),
    tools=[
    ],
    end_strategy="exhaustive",  #'early'
    instrument=True,
    output_type=str,
)


class StockHistoryRequest(BaseModel):
    ticker: str = Field("The instrument to get prices for.")
    period: Literal["1d", "5d", "1mo", "3mo", "6mo"] = Field(
        "How many days/months back in time the Stock prices are requested for."
    )


class DailyPrices(BaseModel):
    date: datetime = Field("Day that these prices are for.")
    open: float = Field(description="Opening price on that day")
    high: float = Field(description="Highest Price on that day")
    low: float = Field(description="Lowest price on that day")
    close: float = Field(description="Closing price.")
    volume: int = Field(description="Total number of shared traded that day.")


class NewsPiece(BaseModel):
    title: str = Field(description="Title of the news story")
    description: str = Field("Summary of the news story")
    content: str = Field(description="The full news story.", default=None)


class InstrumentInformation(BaseModel):
    """Any information about the invesment instrument"""
    daily_prices: list[DailyPrices]
    news_pieces: list[NewsPiece]



def read_yahoo_news_article(url: str) -> str:
    print(url)
    import requests
    from bs4 import BeautifulSoup

    headers = {
        "User-Agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) "
                      "AppleWebKit/537.36 (KHTML, like Gecko) "
                      "Chrome/114.0.0.0 Safari/537.36"
    }

    # Fetch the page
    response = requests.get(url, headers=headers)
    response.raise_for_status()
    html = response.text

    # Parse and extract
    soup = BeautifulSoup(html, "html.parser")
    body_div = soup.find("div", class_="body")

    content=data_collection_agent.run_sync(str(body_div))
    print(content.output)
    return content.output


async def get_instrument_history(req: StockHistoryRequest) -> InstrumentInformation | ToolError:
    """This function can be used to query daily stock prices over a given period up until today."""

    try:
        # Fetch data for Apple Inc. (AAPL)
        tick = yf.Ticker(req.ticker)

        # Get historical data (e.g., last 6 months)
        history = tick.history(period=req.period)
        daily_prices =  [
            DailyPrices(
                date=date,
                open=row.Open,
                high=row.High,
                low=row.Low,
                close=row.Close,
                volume=row.Volume,
            )
            for date, row in history.iterrows()
        ]
        news_pieces=[NewsPiece(title=n['content']['title'], summary=n['content']['summary'], content=read_yahoo_news_article(n['content']['canonicalUrl']['url'])) for n in tick.news]

        return InstrumentInformation(
            daily_prices=daily_prices,
            news_pieces=news_pieces
        )
    except Exception as e:
        logfire.error(str(e))
        return ToolError(message=str(e), error_type="RequestError")



if __name__ == "__main__":

    from warrenbotfett.common import Trading212Ticker
    from pprint import pprint

    for t212_ticker in Trading212Ticker:
        yf_ticker=t212_ticker.value.replace('_EQ','').replace('_US','')
        result = get_instrument_history(StockHistoryRequest(ticker=yf_ticker, period="5d"))
        pprint(result)


"""['__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__firstlineno__', '__format__', '__ge__

 '__getattribute__', '__getstate__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__',
 '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__',
 '__static_attributes__', '__str__', '__subclasshook__', '__weakref__', '_analysis', '_data', '_download_options',
 '_earnings', '_earnings_dates', '_expirations', '_fast_info', '_fetch_ticker_tz', '_financials', '_fundamentals',
 '_funds_data', '_get_ticker_tz', '_holders', '_isin', '_lazy_load_price_history', '_message_handler', '_news',
 '_options2df', '_price_history', '_quote', '_shares', '_tz', '_underlying', 'actions', 'analyst_price_targets',
 'balance_sheet', 'balancesheet', 'calendar', 'capital_gains', 'cash_flow', 'cashflow', 'dividends', 'earnings',
 'earnings_dates', 'earnings_estimate', 'earnings_history', 'eps_revisions', 'eps_trend', 'fast_info', 'financials',
 'funds_data', 'get_actions', 'get_analyst_price_targets', 'get_balance_sheet', 'get_balancesheet', 'get_calendar',
 'get_capital_gains', 'get_cash_flow', 'get_cashflow', 'get_dividends', 'get_earnings', 'get_earnings_dates',
 'get_earnings_estimate', 'get_earnings_history', 'get_eps_revisions', 'get_eps_trend', 'get_fast_info',
 'get_financials', 'get_funds_data', 'get_growth_estimates', 'get_history_metadata', 'get_income_stmt',
 'get_incomestmt', 'get_info', 'get_insider_purchases', 'get_insider_roster_holders', 'get_insider_transactions',
 'get_institutional_holders', 'get_isin', 'get_major_holders', 'get_mutualfund_holders', 'get_news', 'get_recommendations',
 'get_recommendations_summary', 'get_revenue_estimate', 'get_sec_filings', 'get_shares', 'get_shares_full', 'get_splits',
 'get_sustainability', 'get_upgrades_downgrades', 'growth_estimates', 'history', 'history_metadata', 'income_stmt',
 'incomestmt', 'info', 'insider_purchases', 'insider_roster_holders', 'insider_transactions', 'institutional_holders',
 'isin', 'live', 'major_holders', 'mutualfund_holders', 'news', 'option_chain', 'options', 'quarterly_balance_sheet',
 'quarterly_balancesheet', 'quarterly_cash_flow', 'quarterly_cashflow', 'quarterly_earnings', 'quarterly_financials',
 'quarterly_income_stmt', 'quarterly_incomestmt', 'recommendations', 'recommendations_summary', 'revenue_estimate',
 'sec_filings', 'session', 'shares', 'splits', 'sustainability', 'ticker', 'ttm_cash_flow', 'ttm_cashflow',
 'ttm_financials', 'ttm_income_stmt', 'ttm_incomestmt', 'upgrades_downgrades', 'ws']
 
 
 
 {'id': '809a18f3-cce1-3d06-a727-679daac7b29c', 'content': {'id': '809a18f3-cce1-3d06-a727-679daac7b29c', 'contentType': 'VIDEO', 'title': "Apple could grab 'a lot' of market share with foldable iPhones", 'description': '<p>According to <a data-i13n="cpos:1;pos:1" href="https://www.bloomberg.com/news/newsletters/2025-07-20/apple-s-2026-foldable-iphone-samsung-comparison-m5-ipad-pro-dual-front-cameras">reports from Bloomberg</a>, Apple (<a data-i13n="cpos:2;pos:1" href="https://finance.yahoo.com/quote/AAPL">AAPL</a>) will be releasing its first foldable iPhone next year. IDC research director for mobile devices and AR/VR Ramon Llamas joins Asking for a Trend with <a data-i13n="cpos:3;pos:1" href="https://finance.yahoo.com/author/josh-lipton/">Josh Lipton</a> to discuss the reports.</p>\n<p>To watch more expert insights and analysis on the latest market action, check out more Asking for a Trend <a data-i13n="cpos:4;pos:1" href="https://finance.yahoo.com/videos/series/asking-for-a-trend/">here</a>.</p>', 'summary': 'According to reports from Bloomberg, Apple (AAPL) will be releasing its first foldable iPhone next year. IDC research director for mobile devices and AR/VR Ramon Llamas joins Asking for a Trend with Josh Lipton to discuss the reports. To watch more expert insights and analysis on the latest market action, check out more Asking for a Trend here.', 'pubDate': '2025-07-21T21:30:00Z', 'displayTime': '', 'isHosted': True, 'bypassModal': False, 'previewUrl': None, 'thumbnail': {'originalUrl': 'https://s.yimg.com/os/creatr-uploaded-images/2025-07/2823b180-6675-11f0-bede-af44581df8eb', 'originalWidth': 2822, 'originalHeight': 1589, 'caption': '', 'resolutions': [{'url': 'https://s.yimg.com/uu/api/res/1.2/BktSzjeYiwwmXfj_Lw6NLg--~B/aD0xNTg5O3c9MjgyMjthcHBpZD15dGFjaHlvbg--/https://s.yimg.com/os/creatr-uploaded-images/2025-07/2823b180-6675-11f0-bede-af44581df8eb', 'width': 2822, 'height': 1589, 'tag': 'original'}, {'url': 'https://s.yimg.com/uu/api/res/1.2/e4pKy2_YnoF2Ems3QciheA--~B/Zmk9c3RyaW07aD0xMjg7dz0xNzA7YXBwaWQ9eXRhY2h5b24-/https://s.yimg.com/os/creatr-uploaded-images/2025-07/2823b180-6675-11f0-bede-af44581df8eb', 'width': 170, 'height': 128, 'tag': '170x128'}]}, 'provider': {'displayName': 'Yahoo Finance Video', 'url': 'https://finance.yahoo.com/'}, 'canonicalUrl': {'url': 'https://finance.yahoo.com/video/apple-could-grab-lot-market-213000931.html', 'site': 'finance', 'region': 'US', 'lang': 'en-US'}, 'clickThroughUrl': {'url': 'https://finance.yahoo.com/video/apple-could-grab-lot-market-213000931.html', 'site': 'finance', 'region': 'US', 'lang': 'en-US'}, 'metadata': {'editorsPick': True}, 'finance': {'premiumFinance': {'isPremiumNews': False, 'isPremiumFreeNews': False}}, 'storyline': None}}
{'id': '38deff8c-54d0-357a-b2dc-12657da4966b', 'content': {'id': '38deff8c-54d0-357a-b2dc-12657da4966b', 'contentType': 'VIDEO', 'title': 'CoreWeave, Opendoor, Apple: Trending Tickers', 'description': '<p>CoreWeave (<a data-i13n="cpos:1;pos:1" href="https://finance.yahoo.com/quote/CRWV">CRWV</a>) stock pops after announcing a $1.5 billion bond sale to fund its debt payments.</p>\n<p>Opendoor (<a data-i13n="cpos:2;pos:1" href="https://finance.yahoo.com/quote/OPEN">OPEN</a>) stock skyrockets after more than doubling the week prior.</p>\n<p>Apple (<a data-i13n="cpos:3;pos:1" href="https://finance.yahoo.com/quote/AAPL">AAPL</a>) is reportedly working on a foldable phone, according to <a data-i13n="cpos:4;pos:1" href="https://finance.yahoo.com/news/apples-esim-only-foldable-iphone-183837318.html">TF International Securities analysts</a> and <a data-i13n="cpos:5;pos:1" href="https://www.bloomberg.com/news/newsletters/2025-07-20/apple-s-2026-foldable-iphone-samsung-comparison-m5-ipad-pro-dual-front-cameras">Bloomberg</a>.</p>\n<p>To watch more expert insights and analysis on the latest market action, check out more Market Catalysts <a data-i13n="cpos:6;pos:1" href="https://finance.yahoo.com/videos/series/market-catalysts/">here</a>.</p>', 'summary': 'CoreWeave (CRWV) stock pops after announcing a $1.5 billion bond sale to fund its debt payments. Opendoor (OPEN) stock skyrockets after more than doubling the week prior. Apple (AAPL) is reportedly working on a foldable phone, according to TF International Securities analysts and Bloomberg. To watch more expert insights and analysis on the latest market action, check out more Market Catalysts here.', 'pubDate': '2025-07-21T16:07:47Z', 'displayTime': '', 'isHosted': True, 'bypassModal': False, 'previewUrl': None, 'thumbnail': {'originalUrl': 'https://s.yimg.com/os/creatr-uploaded-images/2025-07/a8842be0-664b-11f0-b7ff-0ea2b689b1cf', 'originalWidth': 4500, 'originalHeight': 2528, 'caption': '', 'resolutions': [{'url': 'https://s.yimg.com/uu/api/res/1.2/S5BKOY2M59OwWPZoO5nQbw--~B/aD0yNTI4O3c9NDUwMDthcHBpZD15dGFjaHlvbg--/https://s.yimg.com/os/creatr-uploaded-images/2025-07/a8842be0-664b-11f0-b7ff-0ea2b689b1cf', 'width': 4500, 'height': 2528, 'tag': 'original'}, {'url': 'https://s.yimg.com/uu/api/res/1.2/Vlhc2Wj46plGrbTNABnRCw--~B/Zmk9c3RyaW07aD0xMjg7dz0xNzA7YXBwaWQ9eXRhY2h5b24-/https://s.yimg.com/os/creatr-uploaded-images/2025-07/a8842be0-664b-11f0-b7ff-0ea2b689b1cf', 'width': 170, 'height': 128, 'tag': '170x128'}]}, 'provider': {'displayName': 'Yahoo Finance Video', 'url': 'https://finance.yahoo.com/'}, 'canonicalUrl': {'url': 'https://finance.yahoo.com/video/coreweave-opendoor-apple-trending-tickers-160747357.html', 'site': 'finance', 'region': 'US', 'lang': 'en-US'}, 'clickThroughUrl': {'url': 'https://finance.yahoo.com/video/coreweave-opendoor-apple-trending-tickers-160747357.html', 'site': 'finance', 'region': 'US', 'lang': 'en-US'}, 'metadata': {'editorsPick': True}, 'finance': {'premiumFinance': {'isPremiumNews': False, 'isPremiumFreeNews': False}}, 'storyline': None}}
{'id': '51eef12d-9add-3b07-9204-9692b039d281', 'content': {'id': '51eef12d-9add-3b07-9204-9692b039d281', 'contentType': 'STORY', 'title': 'Polen Focus Growth Strategy Exited Apple (AAPL) in Q2. Here’s Why', 'description': '', 'summary': 'Polen Capital, an investment management company, released its “Polen Focus Growth Strategy” second quarter 2025 investor letter. A copy of the letter can be downloaded here. The market sentiment shifted in the second quarter, from a sharp decline to a V-shaped recovery. In the second quarter, the strategy returned 9.36% (gross) and 9.15% (net) compared […]', 'pubDate': '2025-07-22T14:35:44Z', 'displayTime': '2025-07-22T14:35:44Z', 'isHosted': True, 'bypassModal': False, 'previewUrl': None, 'thumbnail': {'originalUrl': 'https://media.zenfs.com/en/insidermonkey.com/32a877472d13d269a9512661f52b111b', 'originalWidth': 768, 'originalHeight': 430, 'caption': 'UBS Keeps $210 Target on Apple (AAPL) — China Still Key in Supply Chain', 'resolutions': [{'url': 'https://s.yimg.com/uu/api/res/1.2/Sno5_WxuIzB2qIyxjS54gg--~B/aD00MzA7dz03Njg7YXBwaWQ9eXRhY2h5b24-/https://media.zenfs.com/en/insidermonkey.com/32a877472d13d269a9512661f52b111b', 'width': 768, 'height': 430, 'tag': 'original'}, {'url': 'https://s.yimg.com/uu/api/res/1.2/XrtAW4XWx4wShgcpkanZ0g--~B/Zmk9c3RyaW07aD0xMjg7dz0xNzA7YXBwaWQ9eXRhY2h5b24-/https://media.zenfs.com/en/insidermonkey.com/32a877472d13d269a9512661f52b111b', 'width': 170, 'height': 128, 'tag': '170x128'}]}, 'provider': {'displayName': 'Insider Monkey', 'url': 'http://www.insidermonkey.com'}, 'canonicalUrl': {'url': 'https://finance.yahoo.com/news/polen-focus-growth-strategy-exited-143544146.html', 'site': 'finance', 'region': 'US', 'lang': 'en-US'}, 'clickThroughUrl': {'url': 'https://finance.yahoo.com/news/polen-focus-growth-strategy-exited-143544146.html', 'site': 'finance', 'region': 'US', 'lang': 'en-US'}, 'metadata': {'editorsPick': False}, 'finance': {'premiumFinance': {'isPremiumNews': False, 'isPremiumFreeNews': False}}, 'storyline': None}}
{'id': '336b42bb-3d88-368f-89b8-a8f113cd0ac4', 'content': {'id': '336b42bb-3d88-368f-89b8-a8f113cd0ac4', 'contentType': 'STORY', 'title': 'Is TSMC the Only AI Stock You Need?', 'description': '', 'summary': "Shares of Taiwan Semiconductor gained after its Q2 earnings report.  Earnings season is kicking off again, and one of the biggest companies to report earnings so far is Taiwan Semiconductor Manufacturing (NYSE: TSM), or TSMC as it's also known.  TSMC is the world's biggest manufacturer of semiconductors, and it pioneered the foundry model.", 'pubDate': '2025-07-22T14:00:00Z', 'displayTime': '2025-07-22T14:00:00Z', 'isHosted': True, 'bypassModal': False, 'previewUrl': None, 'thumbnail': {'originalUrl': 'https://media.zenfs.com/en/motleyfool.com/242c752cdc716734a003867547697f49', 'originalWidth': 1200, 'originalHeight': 675, 'caption': 'A semiconductor being made.', 'resolutions': [{'url': 'https://s.yimg.com/uu/api/res/1.2/t9g3G4rWrhNgtlDohqe0.w--~B/aD02NzU7dz0xMjAwO2FwcGlkPXl0YWNoeW9u/https://media.zenfs.com/en/motleyfool.com/242c752cdc716734a003867547697f49', 'width': 1200, 'height': 675, 'tag': 'original'}, {'url': 'https://s.yimg.com/uu/api/res/1.2/9nflISlM8oOWHm1oLtH7MQ--~B/Zmk9c3RyaW07aD0xMjg7dz0xNzA7YXBwaWQ9eXRhY2h5b24-/https://media.zenfs.com/en/motleyfool.com/242c752cdc716734a003867547697f49', 'width': 170, 'height': 128, 'tag': '170x128'}]}, 'provider': {'displayName': 'Motley Fool', 'url': 'http://www.fool.com/'}, 'canonicalUrl': {'url': 'https://www.fool.com/investing/2025/07/22/is-tsmc-the-only-ai-stock-you-need/', 'site': 'finance', 'region': 'US', 'lang': 'en-US'}, 'clickThroughUrl': {'url': 'https://finance.yahoo.com/news/tsmc-only-ai-stock-140000471.html', 'site': 'finance', 'region': 'US', 'lang': 'en-US'}, 'metadata': {'editorsPick': False}, 'finance': {'premiumFinance': {'isPremiumNews': False, 'isPremiumFreeNews': False}}, 'storyline': None}}
{'id': '03e802d8-475b-399a-9f67-9621334acad3', 'content': {'id': '03e802d8-475b-399a-9f67-9621334acad3', 'contentType': 'STORY', 'title': 'Alphabet Earnings Optimism Outweighs Looming Antitrust Risks', 'description': '', 'summary': '(Bloomberg) -- After months of underperforming their tech peers, Alphabet Inc. shares are finally showing signs of life as investors bet that a strong earnings performance will outweigh concerns about a looming antitrust ruling.Most Read from BloombergWhy the Federal Reserve’s Building Renovation Costs $2.5 BillionSalt Lake City Turns Winter Olympic Bid Into Statewide Bond BoomMilan Corruption Probe Casts Shadow Over Property BoomHow San Jose’s Mayor Is Working to Build an AI CapitalThe stock ju', 'pubDate': '2025-07-22T13:37:10Z', 'displayTime': '2025-07-22T13:37:10Z', 'isHosted': True, 'bypassModal': False, 'previewUrl': None, 'thumbnail': {'originalUrl': 'https://media.zenfs.com/en/bloomberg_holding_pen_162/47012de3c98088184d42aed4b50672ca', 'originalWidth': 1240, 'originalHeight': 782, 'caption': '', 'resolutions': [{'url': 'https://s.yimg.com/uu/api/res/1.2/alzs_uSf6L0GK9ihjcrwwA--~B/aD03ODI7dz0xMjQwO2FwcGlkPXl0YWNoeW9u/https://media.zenfs.com/en/bloomberg_holding_pen_162/47012de3c98088184d42aed4b50672ca', 'width': 1240, 'height': 782, 'tag': 'original'}, {'url': 'https://s.yimg.com/uu/api/res/1.2/9wjrHmPXMEcXCWuL4D4TUw--~B/Zmk9c3RyaW07aD0xMjg7dz0xNzA7YXBwaWQ9eXRhY2h5b24-/https://media.zenfs.com/en/bloomberg_holding_pen_162/47012de3c98088184d42aed4b50672ca', 'width': 170, 'height': 128, 'tag': '170x128'}]}, 'provider': {'displayName': 'Bloomberg', 'url': 'https://www.bloomberg.com/company'}, 'canonicalUrl': {'url': 'https://finance.yahoo.com/news/alphabet-earnings-optimism-outweighs-looming-105855606.html', 'site': 'finance', 'region': 'US', 'lang': 'en-US'}, 'clickThroughUrl': {'url': 'https://finance.yahoo.com/news/alphabet-earnings-optimism-outweighs-looming-105855606.html', 'site': 'finance', 'region': 'US', 'lang': 'en-US'}, 'metadata': {'editorsPick': False}, 'finance': {'premiumFinance': {'isPremiumNews': False, 'isPremiumFreeNews': False}}, 'storyline': None}}
{'id': '040f42e5-87bb-3af2-b70c-fbe9a2c56659', 'content': {'id': '040f42e5-87bb-3af2-b70c-fbe9a2c56659', 'contentType': 'STORY', 'title': 'PSQ Holdings adds Apple, Google Pay to its PSQ Payments platform', 'description': '', 'summary': 'PublicSquare (PSQH) announced the successful integration and launch of Apple Pay (AAPL) and Google Pay (GOOGL) across its PSQ Payments platform. The company stated this strategic expansion enhances the platform’s capabilities and provides merchants with a seamless and secure mobile payment solution. PublicSquare Chairman and CEO Michael Seifert said the launch is a direct response to merchant feedback and will help merchants optimize their sales funnel for mobile consumers. Published first on Th', 'pubDate': '2025-07-22T13:10:49Z', 'displayTime': '2025-07-22T13:10:49Z', 'isHosted': True, 'bypassModal': False, 'previewUrl': None, 'thumbnail': {'originalUrl': 'https://media.zenfs.com/en/tipranks_452/30b1d840e249361a7df9dbeb9efcfd03', 'originalWidth': 192, 'originalHeight': 192, 'caption': 'https://www.tipranks.com/news/the-fly/psq-holdings-adds-apple-google-pay-to-its-psq-payments-platform-thefly', 'resolutions': [{'url': 'https://s.yimg.com/uu/api/res/1.2/XR0QCXJ9U_8vNrd5k2R5sQ--~B/aD0xOTI7dz0xOTI7YXBwaWQ9eXRhY2h5b24-/https://media.zenfs.com/en/tipranks_452/30b1d840e249361a7df9dbeb9efcfd03', 'width': 192, 'height': 192, 'tag': 'original'}, {'url': 'https://s.yimg.com/uu/api/res/1.2/jvRrO3KWYZJDdTdRNTRkNQ--~B/Zmk9c3RyaW07aD0xMjg7dz0xNzA7YXBwaWQ9eXRhY2h5b24-/https://media.zenfs.com/en/tipranks_452/30b1d840e249361a7df9dbeb9efcfd03', 'width': 170, 'height': 128, 'tag': '170x128'}]}, 'provider': {'displayName': 'TipRanks', 'url': 'https://www.tipranks.com/'}, 'canonicalUrl': {'url': 'https://finance.yahoo.com/news/psq-holdings-adds-apple-google-131049160.html', 'site': 'finance', 'region': 'US', 'lang': 'en-US'}, 'clickThroughUrl': {'url': 'https://finance.yahoo.com/news/psq-holdings-adds-apple-google-131049160.html', 'site': 'finance', 'region': 'US', 'lang': 'en-US'}, 'metadata': {'editorsPick': False}, 'finance': {'premiumFinance': {'isPremiumNews': False, 'isPremiumFreeNews': False}}, 'storyline': None}}
{'id': 'c390b7d5-e806-3352-913d-39cdfb498a35', 'content': {'id': 'c390b7d5-e806-3352-913d-39cdfb498a35', 'contentType': 'STORY', 'title': 'Why Investors Need to Take Advantage of These 2 Computer and Technology Stocks Now', 'description': '', 'summary': 'The Zacks Earnings ESP is a great way to find potential earnings surprises. Why investors should take advantage now.', 'pubDate': '2025-07-22T13:00:03Z', 'displayTime': '2025-07-22T13:00:03Z', 'isHosted': True, 'bypassModal': False, 'previewUrl': None, 'thumbnail': {'originalUrl': 'https://media.zenfs.com/en/zacks.com/5ecaf2a9bf082a5f3a554e6526b34be0', 'originalWidth': 900, 'originalHeight': 601, 'caption': '', 'resolutions': [{'url': 'https://s.yimg.com/uu/api/res/1.2/w.ILboV799eZj6zbyZJ3SQ--~B/aD02MDE7dz05MDA7YXBwaWQ9eXRhY2h5b24-/https://media.zenfs.com/en/zacks.com/5ecaf2a9bf082a5f3a554e6526b34be0', 'width': 900, 'height': 601, 'tag': 'original'}, {'url': 'https://s.yimg.com/uu/api/res/1.2/v4kFsert0DI2EO2PVwipuA--~B/Zmk9c3RyaW07aD0xMjg7dz0xNzA7YXBwaWQ9eXRhY2h5b24-/https://media.zenfs.com/en/zacks.com/5ecaf2a9bf082a5f3a554e6526b34be0', 'width': 170, 'height': 128, 'tag': '170x128'}]}, 'provider': {'displayName': 'Zacks', 'url': 'http://www.zacks.com/'}, 'canonicalUrl': {'url': 'https://finance.yahoo.com/news/why-investors-advantage-2-computer-130003884.html', 'site': 'finance', 'region': 'US', 'lang': 'en-US'}, 'clickThroughUrl': {'url': 'https://finance.yahoo.com/news/why-investors-advantage-2-computer-130003884.html', 'site': 'finance', 'region': 'US', 'lang': 'en-US'}, 'metadata': {'editorsPick': False}, 'finance': {'premiumFinance': {'isPremiumNews': False, 'isPremiumFreeNews': False}}, 'storyline': None}}
{'id': '7b7a533c-2c24-34b9-8560-f42f64b946b4', 'content': {'id': '7b7a533c-2c24-34b9-8560-f42f64b946b4', 'contentType': 'STORY', 'title': 'Cloud AI Update - Revolutionizing Education AI Through Canvas And SchoolAI 2.0', 'description': '', 'summary': 'At InstructureCon 2025, SchoolAI announced a substantial enhancement to its integration with Canvas, the widely utilized Learning Management System in North America. This upgraded integration, part of SchoolAI 2.0, is designed to seamlessly incorporate AI-powered active learning and student support into classroom environments, providing educators with more accessible and effective tools across all disciplines. New capabilities, such as Canvas-Aware Spaces and Always-Available Virtual Teaching...', 'pubDate': '2025-07-22T12:37:41Z', 'displayTime': '2025-07-22T12:37:41Z', 'isHosted': True, 'bypassModal': False, 'previewUrl': None, 'thumbnail': {'originalUrl': 'https://media.zenfs.com/en/simply_wall_st__316/a5d5a89dd6ab73bc7694c99b9023ec2d', 'originalWidth': 1194, 'originalHeight': 432, 'caption': '', 'resolutions': [{'url': 'https://s.yimg.com/uu/api/res/1.2/eFZZVJx6QdqQsl5Qimg4Rw--~B/aD00MzI7dz0xMTk0O2FwcGlkPXl0YWNoeW9u/https://media.zenfs.com/en/simply_wall_st__316/a5d5a89dd6ab73bc7694c99b9023ec2d', 'width': 1194, 'height': 432, 'tag': 'original'}, {'url': 'https://s.yimg.com/uu/api/res/1.2/u_qGKy4_SqrXf8ApF.x2Vw--~B/Zmk9c3RyaW07aD0xMjg7dz0xNzA7YXBwaWQ9eXRhY2h5b24-/https://media.zenfs.com/en/simply_wall_st__316/a5d5a89dd6ab73bc7694c99b9023ec2d', 'width': 170, 'height': 128, 'tag': '170x128'}]}, 'provider': {'displayName': 'Simply Wall St.', 'url': 'https://simplywall.st/'}, 'canonicalUrl': {'url': 'https://finance.yahoo.com/news/cloud-ai-revolutionizing-education-ai-123741602.html', 'site': 'finance', 'region': 'US', 'lang': 'en-US'}, 'clickThroughUrl': {'url': 'https://finance.yahoo.com/news/cloud-ai-revolutionizing-education-ai-123741602.html', 'site': 'finance', 'region': 'US', 'lang': 'en-US'}, 'metadata': {'editorsPick': False}, 'finance': {'premiumFinance': {'isPremiumNews': False, 'isPremiumFreeNews': False}}, 'storyline': None}}
{'id': 'ca58bd52-2be9-3e62-b512-c608bacb30f7', 'content': {'id': 'ca58bd52-2be9-3e62-b512-c608bacb30f7', 'contentType': 'STORY', 'title': 'Google, Tesla and Mag 7 Fortunes Diverge. But Watch for These AI Winners.', 'description': '', 'summary': 'Stock market momentum stalls, TSMC joins $1 trillion club, short sellers circle Opendoor, and more news to start your day.', 'pubDate': '2025-07-22T10:58:00Z', 'displayTime': '2025-07-22T10:58:00Z', 'isHosted': False, 'bypassModal': False, 'previewUrl': 'https://finance.yahoo.com/m/ca58bd52-2be9-3e62-b512-c608bacb30f7/google-tesla-and-mag-7.html', 'thumbnail': {'originalUrl': 'https://media.zenfs.com/en/Barrons.com/09516e196de40b4b486beb6f60878ccd', 'originalWidth': 1280, 'originalHeight': 640, 'caption': '', 'resolutions': [{'url': 'https://s.yimg.com/uu/api/res/1.2/5YZDurmHejZ_WAvUIqrpgA--~B/aD02NDA7dz0xMjgwO2FwcGlkPXl0YWNoeW9u/https://media.zenfs.com/en/Barrons.com/09516e196de40b4b486beb6f60878ccd', 'width': 1280, 'height': 640, 'tag': 'original'}, {'url': 'https://s.yimg.com/uu/api/res/1.2/yKGyNCpiUaVRwpJ1lgWIGQ--~B/Zmk9c3RyaW07aD0xMjg7dz0xNzA7YXBwaWQ9eXRhY2h5b24-/https://media.zenfs.com/en/Barrons.com/09516e196de40b4b486beb6f60878ccd', 'width': 170, 'height': 128, 'tag': '170x128'}]}, 'provider': {'displayName': 'Barrons.com', 'url': 'http://www.barrons.com/'}, 'canonicalUrl': {'url': 'https://www.barrons.com/articles/google-tesla-ai-winners-things-to-know-today-e4eae8fb?siteid=yhoof2&yptr=yahoo', 'site': 'finance', 'region': 'US', 'lang': 'en-US'}, 'clickThroughUrl': None, 'metadata': {'editorsPick': False}, 'finance': {'premiumFinance': {'isPremiumNews': False, 'isPremiumFreeNews': False}}, 'storyline': None}}
{'id': '70cdc084-da69-303a-9704-68f7425d4359', 'content': {'id': '70cdc084-da69-303a-9704-68f7425d4359', 'contentType': 'STORY', 'title': 'Apple’s Tim Cook is under pressure—but there are a few key reasons leadership experts think he’s still the guy for the job', 'description': '', 'summary': 'Looking at the big picture, some experts say Cook might remain CEO for years—and that might be the best course for Apple.', 'pubDate': '2025-07-22T10:00:00Z', 'displayTime': '2025-07-22T10:00:00Z', 'isHosted': True, 'bypassModal': False, 'previewUrl': None, 'thumbnail': {'originalUrl': 'https://media.zenfs.com/en/fortune_175/c542c21f2e21dcdd5c85586fd4e83d02', 'originalWidth': 2048, 'originalHeight': 1401, 'caption': 'Apple CEO Tim Cook has unfinished business when it comes to AI, some experts posit.', 'resolutions': [{'url': 'https://s.yimg.com/uu/api/res/1.2/3CfAp9wNfpxicgQ6EEBQtQ--~B/aD0xNDAxO3c9MjA0ODthcHBpZD15dGFjaHlvbg--/https://media.zenfs.com/en/fortune_175/c542c21f2e21dcdd5c85586fd4e83d02', 'width': 2048, 'height': 1401, 'tag': 'original'}, {'url': 'https://s.yimg.com/uu/api/res/1.2/POjbI9.aewpmivv_gWF9nA--~B/Zmk9c3RyaW07aD0xMjg7dz0xNzA7YXBwaWQ9eXRhY2h5b24-/https://media.zenfs.com/en/fortune_175/c542c21f2e21dcdd5c85586fd4e83d02', 'width': 170, 'height': 128, 'tag': '170x128'}]}, 'provider': {'displayName': 'Fortune', 'url': 'http://fortune.com/'}, 'canonicalUrl': {'url': 'https://finance.yahoo.com/news/apple-tim-cook-under-pressure-100000898.html', 'site': 'finance', 'region': 'US', 'lang': 'en-US'}, 'clickThroughUrl': {'url': 'https://finance.yahoo.com/news/apple-tim-cook-under-pressure-100000898.html', 'site': 'finance', 'region': 'US', 'lang': 'en-US'}, 'metadata': {'editorsPick': False}, 'finance': {'premiumFinance': {'isPremiumNews': False, 'isPremiumFreeNews': False}}, 'storyline': None}}

 
 
 
 <div class="body yf-1ir6o1g">  <div class="atoms-wrapper">  <p class="yf-1090901">Is it time for <a href="https://fortune.com/company/apple/" rel="nofollow noopener" target="_blank" data-ylk="slk:Apple;elm:context_link;itc:0;sec:content-canvas" class="link " data-rapid_p="12" data-v9y="1">Apple</a> CEO Tim Cook to clean out his office? You might think so after the past few weeks. But top experts on CEO successions counsel settling down and looking at the big picture. It shows why Cook might remain CEO for years and why that might even be the best course for Apple.</p>  <p class="yf-1090901">The recent depressing news included a top Apple AI executive’s defection to <a href="https://fortune.com/company/facebook/" rel="nofollow noopener" target="_blank" data-ylk="slk:Meta;elm:context_link;itc:0;sec:content-canvas" class="link " data-rapid_p="13" data-v9y="1">Meta</a> just weeks after another high-level AI researcher had left—especially painful because Apple is widely seen as a laggard in the world’s hottest technology, AI. Last month Apple’s annual Worldwide Developer Conference, often a scene of breathtaking new products or services, was “a snoozer,” said Wedbush analyst Dan Ives. While stocks of <a href="https://fortune.com/company/microsoft/" rel="nofollow noopener" target="_blank" data-ylk="slk:Microsoft;elm:context_link;itc:0;sec:content-canvas" class="link " data-rapid_p="14" data-v9y="1">Microsoft</a> and Alphabet are hitting new highs, Apple is down 16% this year.</p>  <div class="wrapper yf-eondll" data-testid="inarticle-ad"><div id="sda-INARTICLE-70cdc084-da69-303a-9704-68f7425d4359-1" class="sdaContainer dv-all sda-INARTICLE-70cdc084-da69-303a-9704-68f7425d4359-1 yf-1m4k8v7 overflow margin visible placeholder" data-testid="ad-container" data-ad-unit="/22888152279/us/yfin/ros/dt/us_yfin_ros_dt_mid_center" data-ad-size="728x90,300x250,fluid" data-ad-region="main-dynamic" data-ad-loc="mid_center" style="--placeholder-height: 90px;" data-google-query-id="CLr7pMve0I4DFWRY9ggdpcU7iA"><div id="google_ads_iframe_/22888152279/us/yfin/ros/dt/us_yfin_ros_dt_mid_center_3__container__" style="border: 0pt none; display: inline-block; width: 300px; height: 250px;"><iframe frameborder="0" src="https://b4d7f1688388c250bf5fa9aec261ac35.safeframe.googlesyndication.com/safeframe/1-0-45/html/container.html" id="google_ads_iframe_/22888152279/us/yfin/ros/dt/us_yfin_ros_dt_mid_center_3" title="3rd party ad content" name="" scrolling="no" marginwidth="0" marginheight="0" width="300" height="250" data-is-safeframe="true" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" allow="private-state-token-redemption;attribution-reporting" aria-label="Advertisement" tabindex="0" style="border: 0px; vertical-align: bottom;" data-google-container-id="8" data-load-complete="true"></iframe></div></div></div>  <p class="yf-1090901">Little wonder that a Wall Street research firm, Lightshed, concluded Cook is no longer the right boss for Apple. The company “now needs a product-focused CEO, not one centered on logistics,” the firm wrote. “AI is not something that Apple can merely ‘pull the string’ on. Missing on AI could fundamentally alter the company’s long-term trajectory and ability to grow at all.”</p>  <p class="yf-1090901">By earlier standards, Cook would have been on his way out in any case. In August he will have been CEO for 14 years, and in November he turns 65. But 65 is nothing special anymore, and no board of directors will hurry to dispatch a CEO who created far more shareholder value than his legendary predecessor, Steve Jobs, ever did. At least in theory, the options for Cook and the board are wide open.</p>  <div class="wrapper yf-eondll" data-testid="inarticle-ad"><div id="sda-INARTICLE-70cdc084-da69-303a-9704-68f7425d4359-2" class="sdaContainer dv-all sda-INARTICLE-70cdc084-da69-303a-9704-68f7425d4359-2 yf-1m4k8v7 overflow margin visible placeholder" data-testid="ad-container" data-ad-unit="/22888152279/us/yfin/ros/dt/us_yfin_ros_dt_mid_center" data-ad-size="728x90,300x250" data-ad-region="main-dynamic" data-ad-loc="mid_center_2" style="--placeholder-height: 90px;" data-google-query-id="CLv7pMve0I4DFWRY9ggdpcU7iA"><div id="google_ads_iframe_/22888152279/us/yfin/ros/dt/us_yfin_ros_dt_mid_center_4__container__" style="border: 0pt none; display: inline-block; width: 728px; height: 90px;"><iframe frameborder="0" src="https://b4d7f1688388c250bf5fa9aec261ac35.safeframe.googlesyndication.com/safeframe/1-0-45/html/container.html" id="google_ads_iframe_/22888152279/us/yfin/ros/dt/us_yfin_ros_dt_mid_center_4" title="3rd party ad content" name="" scrolling="no" marginwidth="0" marginheight="0" width="728" height="90" data-is-safeframe="true" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" allow="private-state-token-redemption;attribution-reporting" aria-label="Advertisement" tabindex="0" style="border: 0px; vertical-align: bottom;" data-google-container-id="9" data-load-complete="true"></iframe></div></div></div>  <p class="yf-1090901">So what should Cook and the board do? To get an authoritative answer, <em>Fortune</em> recruited three eminent executive search experts, each of whom has counseled scores of major boards on managing successions. We agreed to withhold their names so that they could speak completely candidly. Here are their combined thoughts—as well as the final word from preeminent business historian Richard Tedlow, who gives a compelling comeback to anyone who thinks Cook’s time is up.</p>  <p class="yf-1090901"><strong>Apple’s competitive environment now. </strong>“Two things are happening in parallel. One is AI, which is a much bigger deal than the internet was. The second thing is the evolution of the hardware. There’s a ‘good enough’ problem. For most users, the phones are good enough. I’m a power phone user, and I use a several-year-old iPhone because there’s no compelling reason to upgrade. Those two things in combination make for a more challenging environment for Apple.”</p>  <div class="wrapper yf-eondll" data-testid="inarticle-ad"><div id="sda-INARTICLE-70cdc084-da69-303a-9704-68f7425d4359-3" class="sdaContainer dv-all sda-INARTICLE-70cdc084-da69-303a-9704-68f7425d4359-3 yf-1m4k8v7 overflow margin visible placeholder" data-testid="ad-container" data-ad-unit="/22888152279/us/yfin/ros/dt/us_yfin_ros_dt_mid_center" data-ad-size="728x90,300x250" data-ad-region="main-dynamic" data-ad-loc="mid_center_3" style="--placeholder-height: 90px;" data-google-query-id="CLz7pMve0I4DFWRY9ggdpcU7iA"><div id="google_ads_iframe_/22888152279/us/yfin/ros/dt/us_yfin_ros_dt_mid_center_5__container__" style="border: 0pt none; display: inline-block; width: 728px; height: 90px;"><iframe frameborder="0" src="https://b4d7f1688388c250bf5fa9aec261ac35.safeframe.googlesyndication.com/safeframe/1-0-45/html/container.html" id="google_ads_iframe_/22888152279/us/yfin/ros/dt/us_yfin_ros_dt_mid_center_5" title="3rd party ad content" name="" scrolling="no" marginwidth="0" marginheight="0" width="728" height="90" data-is-safeframe="true" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" allow="private-state-token-redemption;attribution-reporting" aria-label="Advertisement" tabindex="0" style="border: 0px; vertical-align: bottom;" data-google-container-id="a" data-load-complete="true"></iframe></div></div></div>  <p class="yf-1090901"><strong>At the same time, the consultants see a temporary upside for Apple. </strong>“They don’t have the existential threat that <a href="https://fortune.com/company/alphabet/" rel="nofollow noopener" target="_blank" data-ylk="slk:Google;elm:context_link;itc:0;sec:content-canvas" class="link " data-rapid_p="15">Google</a> has from AI. Apple still has the platform—I’m still using my Apple phone to reference ChatGPT. They’re not losing revenue in that exchange. So if you look at where they make money, they actually don’t need a quick entry [into AI].”</p> </div> <div class="readmore  yf-103i3cu"><button class="secondary-btn fin-size-large readmore-button rounded yf-1epmntv" data-ylk="elm:readmore;itc:1;sec:content-canvas;slk:Story%20Continues" aria-label="Story Continues" title="Story Continues" data-rapid_p="16"> <span>Story Continues</span></button></div> <div class="read-more-wrapper" style="display: none" data-testid="read-more"><p class="yf-1090901">“Remember, Apple has never been first to market with anything. They’re considered to be the most innovative company in the world, but they have largely taken a concept that’s been proven and made it applicable for use in ways that are highly innovative and esthetically appealing.”</p><p class="yf-1090901"><strong>Still, the clock has been ticking for a while.</strong> “I would be shocked if within the next 12 months they do not release a truly functioning baseline agent to replace Siri.”</p><div class="wrapper yf-eondll" data-testid="inarticle-ad"><div id="sda-INARTICLE-70cdc084-da69-303a-9704-68f7425d4359-4" class="sdaContainer dv-all sda-INARTICLE-70cdc084-da69-303a-9704-68f7425d4359-4 yf-1m4k8v7 overflow margin visible placeholder" data-testid="ad-container" data-ad-unit="/22888152279/us/yfin/ros/dt/us_yfin_ros_dt_mid_center" data-ad-size="970x250,728x90,300x250" data-ad-region="main-dynamic" data-ad-loc="mid_center_4" style="--placeholder-height: 250px;"></div></div><p class="yf-1090901"><strong>When might Cook be thinking of stepping down?</strong> “That’s really the foundational question. If it’s two years, are there any outsiders who could plausibly come in? Are there any boomerang people who could come back from outside of Apple?”</p><p class="yf-1090901">“Apple is less likely to go outside because of the cultural history of outsiders at Apple. It’s almost revered, the story of how outsiders almost killed Apple [before Steve Jobs returned in 1997]. We hear pretty consistently that Cook is thinking of an age 68 to 70 timeline [which would be three to five years from now.] He feels that, with AI, there’s some unfinished business.”</p><div class="wrapper yf-eondll" data-testid="inarticle-ad"><div id="sda-INARTICLE-70cdc084-da69-303a-9704-68f7425d4359-5" class="sdaContainer dv-all sda-INARTICLE-70cdc084-da69-303a-9704-68f7425d4359-5 yf-1m4k8v7 overflow margin visible placeholder" data-testid="ad-container" data-ad-unit="/22888152279/us/yfin/ros/dt/us_yfin_ros_dt_mid_center" data-ad-size="970x250,728x90,300x250" data-ad-region="main-dynamic" data-ad-loc="mid_center_5" style="--placeholder-height: 250px;"></div></div><p class="yf-1090901">“I don’t think Tim will be CEO until he’s 70. I think he’s tired, honestly. It’s been an exhausting journey, and he’s amazing, but I do sense a different energy.”</p><p class="yf-1090901"><strong>What kind of executive will Cook’s successor be?</strong> “The common wisdom is that they really need a product visionary, as opposed to the operational genius that he was. I would argue that until the tariff and supply chain issues get resolved, they probably do need him at the helm because that is a non-trivial issue for them.”</p><p class="yf-1090901"><strong>Who are the leading candidates to succeed Cook?</strong> “The most obvious are John [Ternus] and Craig [Federighi].” Ternus is senior vice president hardware engineering. Federighi is senior vice president software engineering. “But given the timeline, [the company] could still make quite a few changes, and it could be somebody quite different.”</p><div class="wrapper yf-eondll" data-testid="inarticle-ad"><div id="sda-INARTICLE-70cdc084-da69-303a-9704-68f7425d4359-6" class="sdaContainer dv-all sda-INARTICLE-70cdc084-da69-303a-9704-68f7425d4359-6 yf-1m4k8v7 overflow margin visible placeholder" data-testid="ad-container" data-ad-unit="/22888152279/us/yfin/ros/dt/us_yfin_ros_dt_mid_center" data-ad-size="970x250,728x90,300x250" data-ad-region="main-dynamic" data-ad-loc="mid_center_6" style="--placeholder-height: 250px;"></div></div><p class="yf-1090901">“There are a few companies where being a CEO is really like being the president of a country, and Apple is one of those. There are maybe a dozen. It sounds kind of heretical to say, but to some degree, the smaller part of the job is effectively operating the company.”</p><p class="yf-1090901"><strong>Bottom line, what is the big-picture assessment of Tim Cook? </strong>For this we turn to a business historian, Richard Tedlow, an emeritus professor at the Harvard Business School. Like any good professor, he asks questions. He starts by asking five crucial questions about Apple: Does it satisfy customers? Does it come from behind? Does it have a powerful corporate culture? Is it willing to admit mistakes? Does it have “an imagination of disaster,” a realization that things could go badly wrong? Approvingly, he answers Yes to all. Told that a Wall Street research firm has said Cook should resign, Tedlow notes that Warren Buffett invited Cook to Berkshire Hathaway’s annual meeting in May and said, “I’m somewhat embarrassed to say that Tim Cook has made Berkshire a lot more money than I’ve ever made [for] <a href="https://fortune.com/company/berkshire-hathaway/" rel="nofollow noopener" target="_blank" data-ylk="slk:Berkshire Hathaway;elm:context_link;itc:0;sec:content-canvas" class="link " data-rapid_p="17">Berkshire Hathaway</a>.” Tedlow asks, “If that Wall Street firm called Buffett and said, ‘Warren, do you think it’s time to get rid of Tim Cook,’ what do you think Warren would say?”</p><p class="yf-1090901">Tedlow’s ultimate query: “If you could choose anybody to be the CEO of Apple right now—anybody in the whole history of business, from John Jacob Astor to John D. Rockefeller to Tom Watson Sr. to Andy Grove to Tim Cook—whom would you choose?&nbsp;This is actually not a difficult question.”</p><p class="yf-1090901">This story was originally featured on <a href="https://fortune.com/2025/07/22/apple-tim-cook-leadership-stock-outlook/" rel="nofollow noopener" target="_blank" data-ylk="slk:Fortune.com;elm:context_link;itc:0;sec:content-canvas" class="link " data-rapid_p="18">Fortune.com</a></p> </div>  </div>
"""